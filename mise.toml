[tasks.setup]
description = "Install dependencies"
run = "pnpm install"

[tasks.dev]
description = "Run Vite dev server"
run = "pnpm exec vite dev"

[tasks.build]
description = "Build the frontend"
run = "pnpm exec vite build"

[tasks.preview]
description = "Preview the build"
run = "pnpm exec vite preview"

[tasks.format]
description = "Format code (Biome + dprint + rustfmt)"
run = "pnpm exec biome format --write src src-tauri/tauri.conf.json src-tauri/capabilities/default.json package.json components.json svelte.config.js vite.config.js tailwind.config.ts tsconfig.json biome.json dprint.json && dprint fmt && cargo fmt --manifest-path src-tauri/Cargo.toml"

[tasks.clean]
description = "Remove build artifacts"
run = "rm -rf .svelte-kit build dist package coverage src-tauri/target target node_modules/.vite"

[tasks.clean-deep]
description = "Remove build artifacts + node_modules"
run = "mise run clean && rm -rf node_modules"

[tasks.reset]
description = "Deep clean + setup"
run = "mise run clean-deep && mise run setup"

[tasks.lint]
description = "Lint code (oxlint + clippy)"
run = "pnpm exec oxlint --tsconfig tsconfig.json src && cargo clippy --manifest-path src-tauri/Cargo.toml -- -D warnings"

[tasks.compile]
description = "Typecheck (svelte-check)"
run = "pnpm exec svelte-kit sync && pnpm exec svelte-check --tsconfig ./tsconfig.json"

[tasks.test]
description = "Run unit tests"
run = "pnpm exec vitest run"

[tasks.check]
description = "Format, lint, typecheck, test"
run = "mise run format && mise run lint && mise run compile && mise run test"

[tasks.tauri-dev]
description = "Run the Tauri app"
run = "pnpm exec tauri dev"

[tasks.icons]
description = "Regenerate app icons from assets/logo.svg"
run = "pnpm exec tauri icon assets/logo.svg --output src-tauri/icons"

[tasks.tauri-build]
description = "Build the Tauri app"
run = "pnpm exec tauri build"
